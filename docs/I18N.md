# 国际化 (i18n) 文档

## 概述

本项目使用 `react-i18next` 实现国际化，支持中英文切换。

## 技术栈

- **i18next**: 核心国际化框架
- **react-i18next**: React 集成
- **i18next-browser-languagedetector**: 自动语言检测

## 支持的语言

- 英文 (en) - 默认语言
- 中文 (zh)

## 文件结构

```
src/
├── i18n/
│   ├── config.ts              # i18next 配置
│   ├── index.ts               # 导出入口
│   └── locales/
│       ├── en.ts              # 英文翻译
│       └── zh.ts              # 中文翻译
├── components/
│   └── LanguageSwitcher.tsx   # 语言切换组件
└── pages/                     # 各页面使用 useTranslation
```

## 使用方法

### 1. 在组件中使用翻译

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t('common.title')}</h1>
      <p>{t('common.description')}</p>
    </div>
  );
}
```

### 2. 带参数的翻译

```tsx
// 翻译文件中
export default {
  greeting: {
    welcome: "Welcome, {{name}}!"
  }
}

// 组件中
<p>{t('greeting.welcome', { name: 'Alice' })}</p>
// 输出: Welcome, Alice!
```

### 3. 动态翻译（函数形式）

```tsx
// 翻译文件中
export default {
  toast: {
    foundRoom: {
      description: (players: number, maxPlayers: number) =>
        `Found room with ${players}/${maxPlayers} players!`
    }
  }
}

// 组件中
t('toast.foundRoom.description', { players: 3, maxPlayers: 6 })
```

### 4. 语言切换

语言切换器组件 `<LanguageSwitcher />` 已集成在各页面的 Header 中。

用户选择的语言会自动保存在 localStorage 中，下次访问时自动恢复。

## 添加新翻译

### 步骤 1: 在英文翻译文件中添加键值

编辑 `src/i18n/locales/en.ts`:

```typescript
export default {
  // ... existing translations
  newFeature: {
    title: "New Feature",
    description: "This is a new feature"
  }
}
```

### 步骤 2: 在中文翻译文件中添加对应翻译

编辑 `src/i18n/locales/zh.ts`:

```typescript
export default {
  // ... existing translations
  newFeature: {
    title: "新功能",
    description: "这是一个新功能"
  }
}
```

### 步骤 3: 在组件中使用

```tsx
<h1>{t('newFeature.title')}</h1>
<p>{t('newFeature.description')}</p>
```

## 翻译覆盖范围

### UI 元素
- ✅ 页面标题和副标题
- ✅ 按钮文本
- ✅ 表单标签和输入提示
- ✅ 卡片标题和描述
- ✅ 导航菜单

### Toast 通知消息
- ✅ 成功/错误/警告提示
- ✅ 钱包连接状态
- ✅ 游戏创建/加入反馈
- ✅ 交易确认消息
- ✅ 数字提交/领奖通知

### 已翻译页面
- ✅ LandingPage (首页)
- ✅ CreateRoom (创建房间)
- ✅ JoinRoom (加入房间)
- ⚠️ GamePage (游戏页面 - 部分翻译)
- ⚠️ Leaderboard (排行榜 - 部分翻译)

## 配置说明

### 默认语言设置

在 `src/i18n/config.ts` 中配置:

```typescript
i18n.init({
  fallbackLng: 'en',  // 回退语言
  lng: 'en',          // 初始语言
  // ...
});
```

### 语言检测顺序

1. localStorage (用户上次选择)
2. 浏览器语言设置

### 持久化

用户选择的语言保存在 `localStorage` 的 `i18nextLng` 键中。

## 最佳实践

1. **统一翻译键命名**
   - 使用小驼峰或下划线命名
   - 按功能模块组织 (common, landing, createRoom, toast 等)

2. **避免硬编码文本**
   - 所有用户可见文本都应通过 `t()` 函数
   - 包括 toast 消息、按钮文本、提示信息等

3. **保持翻译同步**
   - 添加英文翻译时，同步添加中文翻译
   - 定期检查是否有遗漏的翻译

4. **使用命名空间** (未来扩展)
   ```tsx
   const { t } = useTranslation('landing');
   t('title'); // 自动查找 landing.title
   ```

## 调试

### 启用调试模式

编辑 `src/i18n/config.ts`:

```typescript
i18n.init({
  debug: true,  // 在控制台显示调试信息
  // ...
});
```

### 检查当前语言

```tsx
import { useTranslation } from 'react-i18next';

function MyComponent() {
  const { i18n } = useTranslation();
  console.log('Current language:', i18n.language);

  // 手动切换语言
  i18n.changeLanguage('zh');
}
```

## 未来改进

- [ ] 添加更多语言 (日语、韩语等)
- [ ] TypeScript 类型安全的翻译键
- [ ] 翻译键自动补全
- [ ] 缺失翻译检测工具
- [ ] 完成 GamePage 和 Leaderboard 的完整翻译
